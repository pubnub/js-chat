<div class="message-list">
    <h1>Message List</h1>
    <div>
        <div>
            <span>Channel pinned message: </span>
            <span>{{ pinnedMessages[channel.id] }}</span>
        </div>
        <div *ngFor="let message of messages">
            <div class="message-row">
                <div class="message-row__content">
                    <div *ngIf="message.quotedMessage">
                        <p>
                            Quoted message: {{ message.quotedMessage.text }}
                        </p>
                        <p>
                            Quote author: {{ message.quotedMessage.userId }}
                        </p>
                    </div>
                    <span *ngFor="let messagePart of message.getLinkedText()">
                        <span class="linked-text" [innerHTML]="renderMessagePart(messagePart) | byPassSecurity"></span>
                    </span>
                </div>
                <div class="message-row__toolbox">
                    <div class="message-row__forward-icon__container" (click)="forwardMessage(message)">
                        <img src="assets/forwardIcon.png" class="message-row__forward-icon" />
                    </div>
                    <div class="message-row__forward-icon__container" (click)="pinMessage(message)">
                        <img src="assets/star.png" class="message-row__forward-icon" />
                    </div>
                    <div class="message-row__forward-icon__container" (click)="loadThreadMessages(message)" *ngIf="message.hasThread">
                        <img src="assets/icon-of-blank-message-dialogue-box-free-vector.webp" class="message-row__forward-icon" />
                    </div>
                    <div class="message-row__forward-icon__container" (click)="openThread(message)">
                        <img src="assets/thick-thread-spool.png" class="message-row__forward-icon" />
                    </div>
                    <div class="message-row__forward-icon__container" (click)="quoteMessage(message)">
                        <img src="assets/quote-mark-icon-symbol-illustration-free-vector.jpeg" class="message-row__forward-icon" />
                    </div>
                </div>
            </div>
            <div class="message-row__thread-messages-container" *ngIf="threadMessages[message.timetoken]">
                <div *ngIf="message.hasThread">
                    <span>Thread pinned message: </span>
                    <span>{{ pinnedMessages[threadMessages[message.timetoken][0].channelId] }}</span>
                </div>
                <div *ngFor="let threadMessage of threadMessages[message.timetoken]">
                    <div class="message-row">
                        <p>
                            {{ threadMessage.content.text }}
                        </p>
                        <div class="message-row__forward-icon__container" (click)="forwardMessage(threadMessage)">
                            <img src="assets/forwardIcon.png" class="message-row__forward-icon" />
                        </div>
                        <div class="message-row__forward-icon__container" (click)="pinThreadMessage(threadMessage)">
                            <img src="assets/star.png" class="message-row__forward-icon" />
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="(message.timetoken === threadInputOpen) && threadChannelOpen" class="thread-input__container">
                <h1>Thread input</h1>
                <app-message-input-chat [channel]="threadChannelOpen" [chat]="chat" />
            </div>
        </div>
    </div>
    <button [disabled]="isPaginationEnd" (click)="loadMoreHistoricalMessages()">Load more historical messages</button>
    <button (click)="inviteSomeoneToThisChannel()">Invite someone to this channel</button>
</div>
